<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MyStore</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Admin panel styles */
    #admin-panel {
      display: none;
      position: fixed;
      top: 5%;
      left: 5%;
      width: 90%;
      height: 90%;
      background: #f5f5f5;
      border: 2px solid #333;
      padding: 20px;
      overflow-y: auto;
      z-index: 100;
    }
    #admin-panel table {
      width: 100%;
      border-collapse: collapse;
    }
    #admin-panel th, #admin-panel td {
      border: 1px solid #333;
      padding: 8px;
      text-align: center;
    }
    #close-admin {
      background: red;
      color: white;
      padding: 5px 10px;
      cursor: pointer;
      float: right;
      margin-bottom: 10px;
    }
    #admin-login-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      padding: 5px 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<header>
  <h1>üõí MyStore</h1>
  <h2>Cart Total: ‚Çπ<span id="total">0</span></h2>
  <button id="admin-login-btn">Admin Login</button>
</header>

<main>
  <div class="products" id="products"></div>
  <div class="cart">
    <h2>Cart</h2>
    <div id="cart-items"></div>
  </div>
</main>

<!-- Admin Panel -->
<div id="admin-panel">
  <button id="close-admin">Close</button>
  <h2>Admin Panel - Edit Products</h2>
  <table id="admin-table">
    <tr>
      <th>Product</th>
      <th>Price (‚Çπ)</th>
      <th>Demand</th>
      <th>Action</th>
    </tr>
    <!-- JS will populate rows -->
  </table>
</div>

<script>
  // ===== PRODUCTS DATA =====
  const products = [
    { id:1, name:"Mouse", basePrice:900, demand:1 },
    { id:2, name:"Keyboard", basePrice:1500, demand:1 },
    { id:3, name:"Monitor", basePrice:12000, demand:1 },
    { id:4, name:"Printer", basePrice:9000, demand:1 },
    { id:5, name:"Headphones", basePrice:3000, demand:1 },
    { id:6, name:"Speaker", basePrice:4500, demand:1 },
    { id:7, name:"Webcam", basePrice:2500, demand:1 },
    { id:8, name:"Power Bank", basePrice:2000, demand:1 },
    { id:9, name:"Tablet", basePrice:18000, demand:1 },
    { id:10, name:"Router", basePrice:3500, demand:1 },
    { id:11, name:"Hard Disk", basePrice:6000, demand:1 },
    { id:12, name:"Pen Drive", basePrice:700, demand:1 },
    { id:13, name:"SSD", basePrice:5000, demand:1 },
    { id:14, name:"Camera", basePrice:30000, demand:1 },
    { id:15, name:"Charger", basePrice:1200, demand:1 },
    { id:16, name:"Tripod", basePrice:1800, demand:1 },
    { id:17, name:"Smart Watch", basePrice:8000, demand:1 },
    { id:18, name:"Earbuds", basePrice:4000, demand:1 },
    { id:19, name:"Microphone", basePrice:2500, demand:1 },
    { id:20, name:"Laptop Stand", basePrice:2000, demand:1 }
  ];

  let cart = [];

  const productsDiv = document.getElementById("products");
  const cartDiv = document.getElementById("cart-items");
  const totalSpan = document.getElementById("total");
  const adminPanel = document.getElementById("admin-panel");
  const adminTable = document.getElementById("admin-table");
  const adminBtn = document.getElementById("admin-login-btn");
  const closeAdmin = document.getElementById("close-admin");

  // ===== DYNAMIC PRICE FUNCTION =====
  function getDynamicPrice(product) {
    return product.basePrice + (product.demand * 10);
  }

  // ===== RENDER PRODUCTS =====
  function renderProducts() {
    productsDiv.innerHTML = "";
    products.forEach(p => {
      const price = getDynamicPrice(p);
      productsDiv.innerHTML += `
        <div class="product">
          <h4>${p.name}</h4>
          <p>Price: ‚Çπ<span>${price}</span></p>
          <p>Demand: <span>${p.demand}</span></p>
          <button onclick="addToCart(${p.id})">Add to Cart</button>
        </div>
      `;
    });
  }

  // ===== ADD TO CART =====
  function addToCart(id) {
    const product = products.find(p => p.id === id);
    product.demand++;
    const price = getDynamicPrice(product);

    const item = cart.find(i => i.id === id);
    if(item) {
      item.qty++;
      item.price = price;
    } else {
      cart.push({ id: id, name: product.name, price: price, qty: 1 });
    }

    renderProducts();
    renderCart();
  }

  function renderCart() {
    cartDiv.innerHTML = "";
    let total = 0;
    cart.forEach(item => {
      total += item.price * item.qty;
      cartDiv.innerHTML += `
        <div>
          ${item.name} (‚Çπ${item.price} √ó ${item.qty})
          <button onclick="changeQty(${item.id},-1)">‚àí</button>
          <button onclick="changeQty(${item.id},1)">+</button>
          <button onclick="removeItem(${item.id})">‚ùå</button>
        </div>
      `;
    });
    totalSpan.innerText = total;
  }

  function changeQty(id, delta) {
    const item = cart.find(i => i.id === id);
    if(!item) return;
    item.qty += delta;
    if(item.qty <= 0) removeItem(id);
    renderCart();
  }

  function removeItem(id) {
    cart = cart.filter(i => i.id !== id);
    renderCart();
  }

  // ===== ADMIN PANEL =====
  adminBtn.addEventListener("click", () => {
    const password = prompt("Enter Admin Password:");
    if(password === "Admin123") {
      adminPanel.style.display = "block";
      generateAdminTable();
    } else {
      alert("Wrong Password!");
    }
  });

  closeAdmin.addEventListener("click", () => {
    adminPanel.style.display = "none";
  });

  function generateAdminTable(){
    // remove old rows except header
    adminTable.querySelectorAll("tr:not(:first-child)").forEach(r=>r.remove());

    products.forEach(p => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${p.name}</td>
        <td><input type="number" id="price-${p.id}" value="${p.basePrice}"></td>
        <td><input type="number" id="demand-${p.id}" value="${p.demand}"></td>
        <td><button onclick="updateProduct(${p.id})">Update</button></td>
      `;
      adminTable.appendChild(tr);
    });
  }

  window.updateProduct = function(id){
    const price = Number(document.getElementById(`price-${id}`).value);
    const demand = Number(document.getElementById(`demand-${id}`).value);

    const prod = products.find(p => p.id === id);
    prod.basePrice = price;
    prod.demand = demand;

    alert(`${prod.name} updated!\nPrice: ‚Çπ${prod.basePrice}, Demand: ${prod.demand}`);

    renderProducts(); // Update user interface immediately
  }

  // ===== INITIAL LOAD =====
  renderProducts();
  renderCart();
</script>
</body>
</html>